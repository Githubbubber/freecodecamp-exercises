<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Calculator Galore!</title>
        <style> button { height: 10px; } </style>
    </head>

    <body>
        <main>
            <div style="border: 2px solid black; border-radius: 10px; margin: 0 auto; width: 50%; height: 300px; background-color: grey;">
                <!-- Error messages-->
                <div id="errorWindow"></div>

                <!-- Display-->
                <div style="background-color: lightblue; border: 2px solid white; width: 80%; height: 50px; margin: 1% 5%; padding: 1%;">
                    <p id="calcWindow" style="text-align: right; font-family: sans-serif; font-size:larger; font-weight: bolder;"></p>
                </div>

                <!-- 1, 2, 3, + -->
                <div style="display: flex;">
                    <button style="flex: 1; height: 30px;" onclick="addPress('1')">1</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('2')">2</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('3')">3</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('+')">+</button>
                </div>

                <!-- 4, 5, 6, - -->
                <div style="display: flex;">
                    <button style="flex: 1; height: 30px;" onclick="addPress('4')">4</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('5')">5</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('6')">6</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('-')">-</button>
                </div>

                <!-- 7, 8, 9, * -->
                <div style="display: flex;">
                    <button style="flex: 1; height: 30px;" onclick="addPress('7')">7</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('8')">8</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('9')">9</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('*')">*</button>
                </div>

                <!-- ., 0, ^, / -->
                <div style="display: flex;">
                    <button style="flex: 1; height: 30px;" onclick="addPress('.')">.</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('0')">0</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('^')">Pow</button>
                    <button style="flex: 1; height: 30px;" onclick="addPress('/')">/</button>
                </div>

                <!-- =, clr, del -->
                <div style="display: flex;">
                    <button style="flex: 1; height: 30px;" onclick="calculate();">Equals</button>
                    <button style="flex: 1; height: 30px;" onclick="clearPress()">Clear</button>
                    <button style="flex: 1; height: 30px;" onclick="deletePress()">Delete</button>
                </div>
            </div>
        </main>

        <script>
            let calcWindow = document.querySelector("#calcWindow");
            let everyPress = [];
            let results;
            let answer = 0;

            const display = function() {
                results = "";

                for (let x = 0; x <= everyPress.length - 1; x++) {
                    let getNum = Number(everyPress[x]);

                    if (getNum) {
                        results = results + everyPress[x];
                    } else {
                        results = results + " " + everyPress[x] + " ";
                    }
                }

                calcWindow.innerHTML = results;
            };

            const add = function(num1, num2) {
                return num1 + num2;
            };

            const subtract = function(num1, num2) {
                return num1 - num2;
            };

            const multiply = function(num1, num2) {
                return num1 * num2;
            };

            const divide = function(num1, num2) {
                return num1 / num2;
            };

            const power = function(num1, num2) {
                return Math.pow(num1, num2);
            };

            // Operate that takes an operator and 2 numbers and then calls one of the above functions on the numbers.
            const operator = function(operand, num1, num2) {
                if (operand === 42) { // *
                    multiply(num1, num2);
                } else if (operand === 47) { // /
                    divide(num1, num2);
                } else if (operand === 43) { // +
                    add(num1, num2);
                } else if (operand === 45 || operand === 49) { // -
                    subtract(num1, num2);
                } else if (operand === 94) {  // ^
                    power(num1, num2);
                } else if (operand === 46) { // .
                    // Gotta figure this one out :( )
                } 
            };
            
            const addPress = function(item) {
                everyPress.push(item);

                display();
            };

            const clearPress = function() {
                everyPress = [];
            
                results = "";

                answer = 0;

                calcWindow.innerHTML = results; 
            };

            const deletePress = function() {
                everyPress.pop();

                results = results.split(results[length-1])[0];

                calcWindow.innerHTML = results;
            };

            const calculate = function() {
                if (results) {
                    let itemsArray = results.replace(/\s/g, "").split(/(\d*)/g).filter(x => x);

                    let newArray = itemsArray.map(item => {
                        let temp = Number(item);

                        if (temp) { return temp; } else { return item; }
                    });

                    if (results.match(/\+|\-|\*|\/|\.|\^/g) === null || results.match(/\d/g) === null || results.length === 1 || newArray.length % 2 === 0) {
                        let errorWindow = document.querySelector("#errorWindow");
                
                        errorWindow.innerHTML = "<p id='msg'>A complete statement is needed for the calculation. Please try again.</p>";

                        setTimeout(() => {
                            errorWindow.removeChild(document.getElementById("msg"));
                        }, 3000);

                        clearTimeout();
                    } else {
                        for (let x = 0; x < newArray.length - 1; x++) {
                            if (!Number(newArray[x])) {
                                let num1 = answer ? answer : newArray[x - 1];
                                let operand = newArray[x].charCodeAt(0);
                                let num2 = newArray[x + 1];

                                operator(num1, operand, num2);
                            }
                        }
                    }

                    calcWindow.innerHTML = answer;
                    results = answer;
                    everyPress = [answer]
                }
            };
        </script>
    </body>
</html>